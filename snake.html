<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clash Royale Clone (Single File)</title>
    <!-- CSS STYLES EMBEDDED HERE -->
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #333;
            margin: 0;
            height: 100vh;
        }
        #game-container {
            width: 800px;
            height: 600px;
            background-color: #4CAF50; /* Green arena */
            position: relative;
            border: 2px solid #000;
            overflow: hidden;
        }
        #river {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 40px;
            background-color: #2196F3; /* Blue river */
            transform: translateY(-50%);
            border-top: 2px solid #000;
            border-bottom: 2px solid #000;
        }
        #ui-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 100px;
            background-color: #555;
            display: flex;
            justify-content: space-around;
            align-items: center;
        }
        .card-slot {
            width: 70px;
            height: 90px;
            background-color: #eee;
            border: 2px solid #000;
            cursor: pointer;
            text-align: center;
            padding-top: 5px;
            box-sizing: border-box;
            user-select: none;
        }
        .card-slot:hover {
            background-color: #fff;
        }
        .troop {
            position: absolute;
            width: 30px;
            height: 40px;
            background-color: red; /* Enemy (Red) */
            border-radius: 50%;
            transition: top 0.1s linear, left 0.1s linear;
        }
        .troop.player {
            background-color: blue; /* Player (Blue) */
        }
        .health-bar {
            position: absolute;
            bottom: 100%;
            left: 0;
            width: 100%;
            height: 5px;
            background-color: grey;
        }
        .health-bar-inner {
            width: 100%;
            height: 100%;
            background-color: green;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="river"></div>
        <div id="ui-bar">
            <!-- The JS function deployTroop is called inline here -->
            <div class="card-slot" onclick="deployTroop(1)">Knight</div>
            <div class="card-slot" onclick="deployTroop(2)">Archer</div>
            <div class="card-slot" onclick="deployTroop(3)">Giant</div>
        </div>
    </div>
    
    <!-- JAVASCRIPT LOGIC EMBEDDED HERE -->
    <script>
        const gameContainer = document.getElementById('game-container');
        const uiBar = document.getElementById('ui-bar');
        // Ensure dimensions are correct once loaded
        const arenaHeight = 500; // Hardcoded height for simplicity in single script
        const playerBaseY = arenaHeight - 50;
        const enemyBaseY = 50;

        let troopId = 0;
        const activeTroops = [];

        // Troop Stats (simple base stats)
        const TROOP_STATS = {
            1: { name: 'Knight', hp: 100, speed: 2, color: 'blue' },
            2: { name: 'Archer', hp: 50, speed: 3, color: 'lightblue' },
            3: { name: 'Giant', hp: 200, speed: 1, color: 'darkblue' },
        };

        function createTroopElement(type, isPlayer) {
            const stats = TROOP_STATS[type];
            const troopEl = document.createElement('div');
            troopEl.classList.add('troop');
            if (isPlayer) {
                troopEl.classList.add('player');
            }
            troopEl.style.backgroundColor = stats.color;

            // Health Bar
            const healthBar = document.createElement('div');
            healthBar.classList.add('health-bar');
            const healthBarInner = document.createElement('div');
            healthBarInner.classList.add('health-bar-inner');
            healthBar.appendChild(healthBarInner);
            troopEl.appendChild(healthBar);

            return troopEl;
        }

        // Make this function globally accessible because it's called from an inline HTML onclick
        window.deployTroop = function(type) {
            // Simple random X position deployment near the player base
            const startX = Math.random() * (gameContainer.clientWidth - 40) + 20;
            const startY = playerBaseY;

            const troopEl = createTroopElement(type, true);
            troopEl.style.left = `${startX}px`;
            troopEl.style.top = `${startY}px`;

            const troopData = {
                id: troopId++,
                type: type,
                element: troopEl,
                x: startX,
                y: startY,
                hp: TROOP_STATS[type].hp,
                maxHp: TROOP_STATS[type].hp,
                speed: TROOP_STATS[type].speed,
                isPlayer: true,
                targetY: enemyBaseY // Target the enemy base
            };

            activeTroops.push(troopData);
            gameContainer.appendChild(troopEl);
            console.log(`Deployed ${TROOP_STATS[type].name}`);
        }

        // Main game loop
        function updateGame() {
            activeTroops.forEach(troop => {
                // Simple movement logic: move towards target Y position
                if (troop.isPlayer) {
                    if (troop.y > troop.targetY) {
                        troop.y -= troop.speed;
                    }
                } else {
                    if (troop.y < troop.targetY) {
                        troop.y += troop.speed;
                    }
                }

                // Update DOM position
                troop.element.style.top = `${troop.y}px`;
            });

            // In a real game, you would handle collision detection, combat, and troop removal here.
            requestAnimationFrame(updateGame);
        }

        // Start the game loop
        requestAnimationFrame(updateGame);

        // Optional: Spawn a dummy enemy troop to fight against
        function spawnInitialEnemy() {
            const startX = Math.random() * (gameContainer.clientWidth - 40) + 20;
            const startY = enemyBaseY;
            const type = 1; // Knight enemy

            const troopEl = createTroopElement(type, false);
            troopEl.style.left = `${startX}px`;
            troopEl.style.top = `${startY}px`;
            troopEl.style.backgroundColor = 'red'; // Ensure enemy is red

            const troopData = {
                id: troopId++,
                type: type,
                element: troopEl,
                x: startX,
                y: startY,
                hp: TROOP_STATS[type].hp,
                maxHp: TROOP_STATS[type].hp,
                speed: TROOP_STATS[type].speed * 0.8, // Slower enemy
                isPlayer: false,
                targetY: playerBaseY // Target the player base
            };

            activeTroops.push(troopData);
            gameContainer.appendChild(troopEl);
            console.log("Spawned initial enemy Knight");
        }

        // Run the initial enemy spawn after the DOM loads
        document.addEventListener('DOMContentLoaded', (event) => {
            spawnInitialEnemy();
        });
    </script>
</body>
</html>
